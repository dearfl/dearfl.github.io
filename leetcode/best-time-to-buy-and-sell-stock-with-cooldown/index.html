<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="index, follow" name=robots><link href=https://flr.me/rss.xml rel=alternate title=RSS type=application/rss+xml><title>dearfl | Best Time to Buy and Sell Stock with Cooldown</title><link as=style href=https://flr.me/css/style.css rel=preload><link href=https://flr.me/css/reset-min.css rel=stylesheet><link href=https://flr.me/css/suCSS-min.css rel=stylesheet><link href=https://flr.me/css/style.css rel=stylesheet><link href=https://flr.me/favicon.ico rel=icon><body><nav id=nav-bar><a href=/> /home/ </a><a href=/post> /post/ </a><a href=/leetcode> /leetcode/ </a><a href=/contact> /contact/ </a></nav><main><article class=post><header class=post-header><h1>Best Time to Buy and Sell Stock with Cooldown</h1></header><div class=post-content><h3 id=description>description</h3><p>You are given an array <code>prices</code> where <code>prices[i]</code> is the price of a given stock on the <code>i<sup>th</sup></code> day.<p>Find the maximum profit you can achieve. You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times) with the following restrictions:<ul><li>After you sell your stock, you cannot buy stock on the next day (i.e., cooldown one day).</ul><p><strong>Note:</strong> You may not engage in multiple transactions simultaneously (i.e., you must sell the stock before you buy again).<p> <p><strong class=example>Example 1:</strong><pre>
<strong>Input:</strong> prices = [1,2,3,0,2]
<strong>Output:</strong> 3
<strong>Explanation:</strong> transactions = [buy, sell, cooldown, buy, sell]
</pre><p><strong class=example>Example 2:</strong><pre>
<strong>Input:</strong> prices = [1]
<strong>Output:</strong> 0
</pre><p> <p><strong>Constraints:</strong><ul><li><code>1 &lt;= prices.length &lt;= 5000</code><li><code>0 &lt;= prices[i] &lt;= 1000</code></ul><hr><h3 id=submission>submission</h3><pre class=language-rs data-lang=rs style=color:#fdf4c1aa;background-color:#282828><code class=language-rs data-lang=rs><span style=color:#928374;font-style:italic>// we'll solve this by dynamic programming and state machine thinking
</span><span style=color:#928374;font-style:italic>// we keep track of max profit of every moments and states
</span><span style=color:#928374;font-style:italic>// we have 3 possible states
</span><span style=color:#928374;font-style:italic>//  - invested: we have bought a stock
</span><span style=color:#928374;font-style:italic>//  - cooldown: we just sold a stock
</span><span style=color:#928374;font-style:italic>//  - uninvested: we can buy a stock immediately
</span><span style=color:#fa5c4b>impl </span><span style=color:#8ec07c>Solution </span><span>{
</span><span>    </span><span style=color:#fa5c4b>pub fn </span><span style=color:#8ec07c>max_profit</span><span>(</span><span style=color:#fdf4c1>prices</span><span>: </span><span style=color:#fabd2f>Vec</span><span>&lt;</span><span style=color:#fa5c4b>i32</span><span>>) -> </span><span style=color:#fa5c4b>i32 </span><span>{
</span><span>        </span><span style=color:#928374;font-style:italic>// make sure we have at least one price
</span><span>        </span><span style=color:#fa5c4b>if</span><span> prices.</span><span style=color:#fabd2f>is_empty</span><span>() {
</span><span>            </span><span style=color:#fa5c4b>return </span><span style=color:#d3869b>0</span><span>;
</span><span>        }
</span><span>        </span><span style=color:#fa5c4b>let </span><span>(</span><span style=color:#fe8019>_</span><span>, cooldown, uninvested) </span><span style=color:#fe8019>=</span><span> prices.</span><span style=color:#fabd2f>iter</span><span>()
</span><span>            .</span><span style=color:#fabd2f>skip</span><span>(</span><span style=color:#d3869b>1</span><span>)
</span><span>            </span><span style=color:#928374;font-style:italic>// init state (invested, cooldown, uninvested)
</span><span>            .</span><span style=color:#fabd2f>fold</span><span>((</span><span style=color:#fe8019>-</span><span>prices[</span><span style=color:#d3869b>0</span><span>], </span><span style=color:#d3869b>0</span><span>, </span><span style=color:#d3869b>0</span><span>), |(</span><span style=color:#fdf4c1>i</span><span>, </span><span style=color:#fdf4c1>c</span><span>, </span><span style=color:#fdf4c1>u</span><span>), </span><span style=color:#fdf4c1>p</span><span>| {
</span><span>                </span><span style=color:#928374;font-style:italic>// we have the following state transition
</span><span>                </span><span style=color:#928374;font-style:italic>// uninvested --buy--> invested
</span><span>                </span><span style=color:#928374;font-style:italic>// invested --sell--> cooldown
</span><span>                </span><span style=color:#928374;font-style:italic>// cooldown --wait--> uninvested
</span><span>                (i.</span><span style=color:#fabd2f>max</span><span>(u </span><span style=color:#fe8019>-</span><span> p), c.</span><span style=color:#fabd2f>max</span><span>(i </span><span style=color:#fe8019>+</span><span> p), u.</span><span style=color:#fabd2f>max</span><span>(c))
</span><span>            });
</span><span>        </span><span style=color:#928374;font-style:italic>// max profit can't happen when we are in invested state 
</span><span>        cooldown.</span><span style=color:#fabd2f>max</span><span>(uninvested)
</span><span>    }
</span><span>}
</span></code></pre></div></article></main><footer><hr><div id=footer-container><p>Made using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> Zola theme</div></footer>